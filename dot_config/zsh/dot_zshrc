# define enviroment variables containing configuration for tools
export BAT_THEME="ansi"
export STARSHIP_CONFIG="$XDG_CONFIG_HOME/starship/config.toml"
export ZNAP_DIR="$HOME/.znap/zsh-snap"
export FZF_DEFAULT_OPTS="--reverse"

# dayfox theme for fzf
export FZF_DEFAULT_OPTS="$FZF_DEFAULT_OPTS --color=fg:#3d2b5a,bg:#f6f2ee,hl:#4863b6
 --color=fg+:#4863b6,bg+:#f6f2ee,hl+:#b86e28
 --color=info:#b86e28,prompt:#b3434e,pointer:#8452d5
 --color=marker:#577f63,spinner:#8452d5,header:#488d93"

# bootstrap plugin manager
source "$ZNAP_DIR/znap.zsh"

# initialize prompt
znap prompt geometry-zsh/geometry

# load plugins
znap source marlonrichert/zcolors
znap source Aloxaf/fzf-tab
znap source zsh-users/zsh-autosuggestions
znap source zsh-users/zsh-completions
znap source zdharma-continuum/fast-syntax-highlighting

# generate LS_COLORS so it's coherent with exa's output
znap eval lscolors "python3 $ZDOTDIR/ls_colors_gen.py"

# generate colored output for git/grep/less using LS_COLORS
znap eval zcolors "zcolors ${(q)LS_COLORS}"

# configure completions (taken from: https://thevaluable.dev/zsh-completion-guide-examples/)
zstyle ':completion:*' menu select
zstyle ':completion:*' completer _extensions _complete _approximate
zstyle ':completion:*' matcher-list '' 'm:{a-zA-Z}={A-Za-z}' 'r:|[._-]=* r:|=*' 'l:|=* r:|=*'
zstyle ':completion:*' squeeze-slashes true
zstyle ':completion:*' list-colors ${(s.:.)LS_COLORS}
zstyle ':completion:*' group-name ''
zstyle ':completion:*' use-cache on
zstyle ':completion:*' cache-path "$XDG_CACHE_HOME/zsh/.zcompcache"

# configure fzf-tab
zstyle ':fzf-tab:*' fzf-flags $(echo $FZF_DEFAULT_OPTS) # fzf-tab needs to be passed fzf flags explicitly
zstyle ':fzf-tab:*' default-color $'\033[39m' # set the foreground color for default result group
zstyle ':fzf-tab:complete:cd:*' fzf-preview 'exa -1 --color=always $realpath' # preview folders with exa

# configure autosuggestions
export ZSH_AUTOSUGGEST_STRATEGY=(history completion)

# set syntax highlighting theme
zstyle :plugin:fast-syntax-highlighting theme base16

# enter emacs mode by default
bindkey -e

# configure fzf keybindings
if [ -d "$(brew --prefix fzf)/shell" ]; then
  source "$(brew --prefix fzf)/shell/key-bindings.zsh"
fi

# prepare shortcuts for frequently used dirs
: ${GITDIR:=$HOME/Developer}
hash -d Dotfiles="$HOME/Documents/Dotfiles"
hash -d Developer="$GITDIR"
hash -d Work="$GITDIR/github.com/Nozbe"

# set shell options
setopt EXTENDED_GLOB
setopt NUMERIC_GLOB_SORT
setopt INTERACTIVE_COMMENTS

# set up aliases for tools
alias g="git"
alias ga="git add"
alias gaa="git add --all"
alias gapa="git add --patch"
alias gb="git branch"
alias gc="git commit -v"
alias gco="git checkout"
alias gcor="git checkout --recurse-submodules"
alias gcp="git cherry-pick"
alias gd="git diff"
alias gf="git fetch"
alias gignore="git update-index --assume-unchanged"
alias gl="git pull"
alias glg="git log --stat"
alias glgg="git log --graph"
alias glo="git log --oneline --decorate"
alias gm="git merge"
alias gp="git push"
alias gr="git remote"
alias grb="git rebase"
alias grbi="git rebase -i"
alias grh="git reset"
alias grhh="git reset --hard"
alias gst="git status"
alias gsw="git switch"
alias gswc="git switch -c"
alias gunignore="git update-index --no-assume-unchanged"
alias lg="lazygit"
alias ls="gls --color=auto"
alias ll="exa --icons -alh"
alias p="pnpm"
alias y="yarn"
alias ya="yarn add"
alias yad="yarn add --dev"
alias yb="yarn build"
alias yd="yarn dev"
alias yga="yarn global add"
alias ygls="yarn global list"
alias ygrm="yarn global remove"
alias ygu="yarn global upgrade"
alias yrm="yarn remove"
alias ys="yarn serve"
alias yst="yarn start"
alias yt="yarn test"
alias yui="yarn upgrade-interactive"
alias yup="yarn upgrade"

# aliases for file previewing
: ${PAGER:=less}
alias -s {css,csv,go,gradle,html,js,json,md,patch,properties,py,ts,txt,xml,yml}=bat
alias -s gz="gzip -l"
alias -s {log,out}="tail -F"

# run zoxide to get the nice dir jumping utility available as `z`
znap eval zoxide "zoxide init zsh"
